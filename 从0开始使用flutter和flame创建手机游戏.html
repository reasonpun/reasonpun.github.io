<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"pangz.fun","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4592202470693653" crossorigin="anonymous"></script><meta name="description" content="为啥要做游戏开发呢？不得不承认，游戏是一个非常让人着迷的活动（孩子们不要沉迷哟）。我很喜欢玩游戏，虽然不是非常非常痴迷，但是也因此入手了好几部游戏机，其实我一直心心念念的向入手一部小霸王（此处可以认为是软广，小霸王不要忘了给我广告费，哈哈）红白机，和我的孩子一起怀念一下我小时候的快乐。你们是不是也有这样的情愫呢？"><meta property="og:type" content="article"><meta property="og:title" content="从0开始使用flutter和flame创建手机游戏"><meta property="og:url" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F.html"><meta property="og:site_name" content="酷学小栈"><meta property="og:description" content="为啥要做游戏开发呢？不得不承认，游戏是一个非常让人着迷的活动（孩子们不要沉迷哟）。我很喜欢玩游戏，虽然不是非常非常痴迷，但是也因此入手了好几部游戏机，其实我一直心心念念的向入手一部小霸王（此处可以认为是软广，小霸王不要忘了给我广告费，哈哈）红白机，和我的孩子一起怀念一下我小时候的快乐。你们是不是也有这样的情愫呢？"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/1.png"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/2.png"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/3.png"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/game-loop.png"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/4.png"><meta property="og:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/5.png"><meta property="article:published_time" content="2022-01-31T01:02:04.000Z"><meta property="article:modified_time" content="2025-01-23T09:09:22.074Z"><meta property="article:author" content="木辛念做梓"><meta property="article:tag" content="Flutter"><meta property="article:tag" content="Flame"><meta property="article:tag" content="Game"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/1.png"><link rel="canonical" href="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F.html","path":"从0开始使用flutter和flame创建手机游戏.html","title":"从0开始使用flutter和flame创建手机游戏"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>从0开始使用flutter和flame创建手机游戏 | 酷学小栈</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-1HVT1YE421"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-1HVT1YE421","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="酷学小栈" type="application/atom+xml">
</head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">酷学小栈</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">还要再走500里</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%85%E5%89%8D%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD"><span class="nav-number">1.</span> <span class="nav-text">阅前必备技能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%82%A3%E4%B9%88%EF%BC%8C%E6%8E%A5%E4%B8%8B%E6%9D%A5%E8%AE%A9%E6%88%91%E4%BB%AC%E5%BC%80%E5%A7%8B%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E4%B9%8B%E6%97%85%E5%90%A7"><span class="nav-number">2.</span> <span class="nav-text">那么，接下来让我们开始游戏开发之旅吧!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAFlutter%E7%A8%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.</span> <span class="nav-text">第一步，创建一个Flutter程序项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%AE%89%E8%A3%85Flame%E6%8F%92%E4%BB%B6%E5%B9%B6%E4%B8%94%E6%B8%85%E7%90%86%E4%B8%80%E4%B8%8B%E9%A1%B9%E7%9B%AE"><span class="nav-number">4.</span> <span class="nav-text">第二步：安装Flame插件并且清理一下项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E8%AE%BE%E7%BD%AE%E6%B8%B8%E6%88%8F%E5%BE%AA%E7%8E%AF%E9%80%BB%E8%BE%91"><span class="nav-number">5.</span> <span class="nav-text">第三步：设置游戏循环逻辑</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E5%95%A5%E9%9C%80%E8%A6%81%E5%90%8C%E6%AD%A5%E6%8D%8F%EF%BC%9F"><span class="nav-number">6.</span> <span class="nav-text">为啥需要同步捏？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Flame"><span class="nav-number">7.</span> <span class="nav-text">使用Flame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E7%BB%98%E5%88%B6%E7%95%8C%E9%9D%A2"><span class="nav-number">8.</span> <span class="nav-text">第四步：绘制界面</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">木辛念做梓</p><div class="site-description" itemprop="description">读万卷书，行万里路，胸中脱去尘浊</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">110</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">21</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">114</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://io-oi.me/" title="https:&#x2F;&#x2F;io-oi.me" rel="noopener" target="_blank">reuixiy</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://pangz.fun/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="木辛念做梓"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="酷学小栈"><meta itemprop="description" content="读万卷书，行万里路，胸中脱去尘浊"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="从0开始使用flutter和flame创建手机游戏 | 酷学小栈"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">从0开始使用flutter和flame创建手机游戏</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-31 09:02:04" itemprop="dateCreated datePublished" datetime="2022-01-31T09:02:04+08:00">2022-01-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-01-23 17:09:22" itemprop="dateModified" datetime="2025-01-23T17:09:22+08:00">2025-01-23</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Flutter/" itemprop="url" rel="index"><span itemprop="name">Flutter</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.4k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>为啥要做游戏开发呢？<br>不得不承认，游戏是一个非常让人着迷的活动（孩子们不要沉迷哟）。<br>我很喜欢玩游戏，虽然不是非常非常痴迷，但是也因此入手了好几部游戏机，其实我一直心心念念的向入手一部小霸王（此处可以认为是软广，小霸王不要忘了给我广告费，哈哈）红白机，和我的孩子一起怀念一下我小时候的快乐。<br>你们是不是也有这样的情愫呢？</p><span id="more"></span><p>游戏之所以这么吸引人，也许是因为，他可以从简单和线性的游戏玩法到真正复杂的涉及 3D、几乎真实的物理引擎、逼真的图形、程序生成的世界以及适应玩家选择的故事情节。</p><p>有很多很多的人，肯定都像木辛老师一样，想做出属于自己的精美、好玩的游戏。如果你在这一群人里边，那么恭喜你，本篇内容将带领你入门一款经典的游戏引擎。不过，本篇更多的关注的是理论知识，暂时没有涉猎实际开发效果，也并没有讲到如何发布游戏。所以，如果你想巩固游戏开发过程中的理论知识，建议你好好读读这篇文章哈。</p><p>编写过程中难免会有纰漏，如果恰巧您发现了这些问题，可以给我留言或者私信告诉我，我会以最快的速度修正，再次非常感谢！</p><h2 id="阅前必备技能"><a href="#阅前必备技能" class="headerlink" title="阅前必备技能"></a>阅前必备技能</h2><p>本文将假设您已经是一名开发人员，并且对开发软件的概念有扎实的掌握。<br>当然了，如果您是新手，那也没有关系，只要您对游戏开发有足够的兴趣，这也是可以的。</p><p>虽然，兴趣是第一老师，是催动你进步的助力，但是这还不算准备就绪。开始游戏，你还需要一台电脑，足够让你配置好开发所需要的环境，以便于可以编写和编译代码。<br>更好一些的，如果你恰巧配备了一台Android手机，那么你就可以在其上进行软件的测试和实际的使用体验啦。<br>SO，欲善其事，先来利其器吧！</p><p>使用Flutter编写的程序可以被编译和构建在Android手机和iOS手机上边。<br>Android手机用的十分广泛，所以本章节会主要以Android手机为例，你可以通过准备的Android设备进行开发和调试，一旦你完成了这个程序，就可以很轻易的通过不同的构建命令实现iOS设备上的运行。</p><p>再一次假设，你已经顺利完成了如下步骤：</p><ol><li>Microsoft Visual Studio Code：使用任何IDE或者文本编辑工具都可以编写程序，当然了，如果你是一个新手，那么强烈推荐你使用VSCode，它将会给你带来一个与众不同的感觉。<br>一定要从官网下载软件哟，否则一不小心下载到流氓软件就不好了。<br>还有一件挺重要的事情，安装好VScode之后可以安装一下Flutte和Dart的插件，虽然这个不是必须要的，但是配置好了以后，对你的开发工作会有很大的帮助。</li></ol><p>如下两个准备，必须要做，一定要做，不得不做吖。<br>Android SDK：如果你想编写Android程序的话，这个一定要有。<br>如果你觉得一步步地配置太麻烦，也可以直接下载Android Studio开发工具，这样就可以一键完成所有配置。<br>当然了，也有一些同学不想安装这个“巨大”的工具，指向最小化安装，那么你只需要安装SDK就可以啦。<br>接下来的这个“装备”，你是必须、必须、必须一定要安装的，否则你就没有办法开发Flutter程序啦！<br>Flutter SDK/Framework：除了Flutter还有Flame这个插件，这个才是我们今天内容的主角，使用这两个玩意才能最终完成游戏的开发。</p><h2 id="那么，接下来让我们开始游戏开发之旅吧"><a href="#那么，接下来让我们开始游戏开发之旅吧" class="headerlink" title="那么，接下来让我们开始游戏开发之旅吧!"></a>那么，接下来让我们开始游戏开发之旅吧!</h2><p>让我们先从一个非常非常简单的开始。<br>我们这款游戏是这样的，在一整个黑色的屏幕中有一块白色的方块，我们把它放置在屏幕的正中间，当你点击这个白色的方块的时候，它就会变成绿色，这样你就赢了（不要太简单啦）。</p><p>我们暂时先不用比较复杂的元素，所以，在这个游戏中我么不会使用图片文件什么的。</p><p>所以，现在正式开始！</p><h2 id="第一步，创建一个Flutter程序项目"><a href="#第一步，创建一个Flutter程序项目" class="headerlink" title="第一步，创建一个Flutter程序项目"></a>第一步，创建一个Flutter程序项目</h2><p>打开终端（就是计算机中可以输入命令行的东东），并且定位到你要创建的项目目录下，然后执行如下命令：</p><pre class="line-numbers language-none"><code class="language-none">$ flutter create boxgame<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此命令使用 Flutter 命令行工具为您初始化和引导一个基本的移动应用程序。</p><p>如果需要，您可以选择除 boxgame 以外的任何名称。只需确保将所有 boxgame 实例替换为您在后续操作中使用的任何内容。</p><p>此时，您可以在 Visual Studio Code 中打开生成的 boxgame 文件夹，也可以使用以下命令立即运行您的应用程序：</p><pre class="line-numbers language-none"><code class="language-none">$ cd boxgame
$ flutter run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>第一次运行新创建的应用程序可能需要一段时间。当移动应用程序运行时，您应该会看到如下内容：</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/1.png" title="第一次运行新项目 width=400"><h2 id="第二步：安装Flame插件并且清理一下项目"><a href="#第二步：安装Flame插件并且清理一下项目" class="headerlink" title="第二步：安装Flame插件并且清理一下项目"></a>第二步：安装Flame插件并且清理一下项目</h2><pre class="line-numbers language-none"><code class="language-none">注意：从这里开始，我们将项目目录称为 ./。如果你的游戏项目在 ~/boxgame 中，./lib/main.dart 指的是 ~/boxgame/lib/main.dart 中的文件。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启动 Visual Studio Code 并打开上一步创建的 boxgame 目录。</p><p>由于我们将使用简单而强大的 Flame 插件，因此我们需要将其添加到我们的应用程序将依赖的 Dart 包列表中。在 IDE 的左侧，您将看到项目文件夹中的文件列表。打开 ./pubspec.yaml 并在依赖项下的 cupertino_icons 行下方添加以下行（注意缩进）。</p><pre class="line-numbers language-none"><code class="language-none">flame: ^1.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>你应该会看到像我这里差不多的样子：</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/2.png" title="VSC打开的样子"><p>如果您使用的是 Visual Studio Code，IDE 将在保存文件时自动为您安装插件。</p><p>您可以通过打开终端、导航到项目文件夹并运行 flutter packages get 来手动完成。</p><p>下一步是清理主代码，删除掉Flutter 项目中./lib/main.dart 文件中所有内容，并将其替换为空程序。</p><p>空程序只有一行：void main() {}。</p><p>您会注意到的一件事是，我们将 import 语句留在了顶部。我们将在稍后启动游戏时运行 runApp 方法时使用material库。您现在应该有如下所示的内容：</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/3.png" title="清空主程序的样子"><p>另一件事是 ./test 文件夹中的文件显示错误。如果您没有使用 Visual Studio Code，这可能不会显示，但您的应用程序将不会运行。</p><p>测试（和测试驱动的开发）超出了本教程的范围，所以要解决这个问题，只需删除整个测试文件夹。</p><h2 id="第三步：设置游戏循环逻辑"><a href="#第三步：设置游戏循环逻辑" class="headerlink" title="第三步：设置游戏循环逻辑"></a>第三步：设置游戏循环逻辑</h2><p>现在我们要设置游戏循环……</p><p>但是什么是游戏循环？<br>游戏循环是游戏的核心。计算机反复运行的一组指令。</p><p>游戏中通常有个概念叫做FPS。它代表每秒帧数。这意味着如果您的游戏以 60 fps 运行，则计算机每秒运行您的游戏循环 60 次。</p><p>简而言之：一帧 = 一次游戏循环。</p><p>一个基本的游戏循环由两部分组成，更新和渲染。</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/game-loop.png" title="game_loop"><p>更新部分处理对象的移动（如角色、敌人、障碍物、地图本身）和其他需要更新的东西（例如计时器）。</p><p>大部分动作都发生在这里。</p><p>例如，计算敌人是否被子弹击中或计算敌人是否接触主角(主角通常不喜欢这样)。</p><p>渲染部分在屏幕上绘制所有对象。这是一个单独的进程，因此一切都是同步的。</p><h2 id="为啥需要同步捏？"><a href="#为啥需要同步捏？" class="headerlink" title="为啥需要同步捏？"></a>为啥需要同步捏？</h2><p>想象一下，如果你正更新主角的位置呐。如果这个主角没啥“异议（没有变化）”，那么一切皆无恙。</p><p>但是，说来不巧，正好有一颗子弹就在几个像素之外。您恰巧更新了子弹，并且它击中了您的角色。</p><p>现在，主角死了，所以你不要拔出子弹。而此时，您绘制完角色垂死动画的第一帧，在下一个周期中，您将跳过更新角色，改为渲染他垂死动画的第一帧（而不是第二帧）。</p><p>这会给你的游戏一种生涩的感觉。想象一下玩射击游戏，你射击一个敌人，他没有倒下，你再次射击，但在子弹击中之前他就死了，死了，死了，了。。。</p><p>非同步渲染的抖动性能可能并不明显（尤其是在每秒运行 60 帧时），但如果这种情况发生得太频繁，玩家就会感觉你这款游戏是不是还没搞完，直接就弃了。</p><p>SO，您是真希望计算所有内容，并且当所有对象的状态都计算并最终确定之后，才会绘制屏幕上。</p><h2 id="使用Flame"><a href="#使用Flame" class="headerlink" title="使用Flame"></a>使用Flame</h2><p>Flame 已经有处理这些边边角角的代码了，所以我们只需要关注编写实际的更新和渲染过程。</p><p>但首先，我们的应用程序需要做两个准备：一个是全屏，一个是竖屏锁定。</p><p>Flame 还为这些提供了实用功能。因此，让我们将它们添加到我们的代码中。</p><p>以下这几行代码请添加到文件的顶部：</p><pre class="line-numbers language-none"><code class="language-none">import 'package:flame/flame.dart';
import 'package:flutter/services.dart';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后在 main 函数中，我们可以直接使用Flame.device静态调用的方式，使用 fullscreen 和 setOrientation 函数，一定要耐心等待哟，因为这些函数返回一个 Future。</p><pre class="line-numbers language-none"><code class="language-none">await Flame.device.fullScreen();
await Flame.device.setOrientation(DeviceOrientation.portraitUp);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>注意：Futures、async 和 await 是编码实践，允许您“等待”一个较长的进程完成而不会阻塞其他所有内容。如果您有兴趣了解它们，</p><a href="https://www.dartlang.org/tutorials/language/futures" title="可以从 Dart 的官方网站阅读此页面" target=""></a> 。<p>为了能够等待 Futures，上下文必须在异步函数中。所以让我们把 main 函数转换成一个异步函数。</p><pre class="line-numbers language-none"><code class="language-none">void main() async {<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>最后，您应该有如下所示的内容：</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/4.png" title="使用flame"><p>要利用 Flame 插件提供的游戏循环机制，我们必须创建一个 Flame 的 Game 类的子类。为此，请在 ./lib 下创建一个新文件并将其命名为 box-game.dart。</p><p>然后我们将编写一个名为 BoxGame 的类（如果你知道类是如何工作的，你可以使用任何类）来扩展 Flame 的 Game 类。</p><pre class="line-numbers language-none"><code class="language-none">import 'dart:ui';

import 'package:flame/game.dart';

class BoxGame extends Game {
  void render(Canvas canvas) {
    // TODO: implement render
  }

  void update(double t) {
    // TODO: implement update
  }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>让我们分解一下：我们导入 Dart 的 ui 库，这样就可以使用 Canvas 类，然后使用 Size 类。<br>我们导入 Flame 的游戏库，其中包括正在扩展的 Game 类。其他所有内容都是具有两种方法的类定义：更新和渲染。这些方法会覆盖父类（也称为超类）的同名方法。</p><pre class="line-numbers language-none"><code class="language-none">注意：@override 注释在 Dart 2 中是可选的，所以，如果你找不到它也不找着急，这是正常的。 
new 关键字也是可选的，所以我们也不会使用它。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>下一步是创建此 BoxGame 类的实例并将其小部件属性传递给 runApp。</p><p>让我们回到 ./lib/main.dart 并在文件的最顶部插入以下行：</p><pre class="line-numbers language-none"><code class="language-none">import 'package:boxgame/box-game.dart';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>该行确保 BoxGame 类可以在 main.dart 中使用。<br>接下来，创建 BoxGame 类的实例并将其小部件属性传递给 runApp 函数。<br>在 main 函数的末尾（右大括号 } 上方）插入以下行。</p><pre class="line-numbers language-none"><code class="language-none">BoxGame game = BoxGame();
runApp(game.widget);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>现在我们的移动应用程序就可以称作是一个游戏啦！</p><p>如果你运行游戏，你只会看到一个空白/黑屏，因为屏幕上还没有绘制任何东西。</p><p>您的 main.dart 文件应如下所示：</p><img src="/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8flutter%E5%92%8Cflame%E5%88%9B%E5%BB%BA%E6%89%8B%E6%9C%BA%E6%B8%B8%E6%88%8F/5.png" title="run_app"><h2 id="第四步：绘制界面"><a href="#第四步：绘制界面" class="headerlink" title="第四步：绘制界面"></a>第四步：绘制界面</h2><p>在屏幕上绘图之前，我们必须提前知道屏幕的大小。<br>Flutter 在屏幕上绘图时使用逻辑像素，因此您不必担心调整游戏对象的大小。</p><p>一英寸的设备包含大约 96 个逻辑像素。因此，假设我们将手机作为我们的发布平台。大多数现代和主流手机的尺寸都差不多，因为我们的游戏非常简单，我们不必担心尺寸。</p><p>Flame 建立在这个大小系统之上，而 Game 类实际上有一个我们可以覆盖的调整大小的函数。这个函数接受一个 Size 参数，我们可以通过这个参数确定屏幕的大小（以逻辑像素为单位）。</p><p>首先，让我们在类级别声明一个变量。这个变量（也称为实例变量）将保存屏幕的大小，并且仅在屏幕改变大小时更新（对于我们的游戏应该只发生一次）。这也是在屏幕上绘制对象时的基础。这个变量的类型应该是 Size。与传递给 resize 函数的内容相同。</p><pre class="line-numbers language-none"><code class="language-none">class BoxGame extends Game {
  Size screenSize;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>screenSize 变量将被初始化为 null。在检查我们是否知道渲染过程中的屏幕大小时，这将很有帮助。稍后再谈。</p><p>接下来，让我们在 ./lib/box-game.dart 中添加重载函数resize()。</p><pre class="line-numbers language-none"><code class="language-none">void resize(Size size) {
  screenSize = size;
  super.resize(size);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>注意：超类的 resize 函数实际上是空的，但调用我们要覆盖的超类的超函数是个好主意。除非我们完全想重写该函数。所以，让我们先把它留在这里吧。</p><p>另一个需要注意的地方：实例变量是可以从类的所有方法/函数访问的变量。例如，您可以在调整大小时设置它，然后在渲染时获取它的值。</p><p>您的代码应如下所示：</p></div><footer class="post-footer"><div class="reward-container"><div>你的鼓励是我更新的动力！</div><button>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.png" alt="木辛念做梓 微信"> <span>微信</span></div><div><img src="/images/alipay.png" alt="木辛念做梓 支付宝"> <span>支付宝</span></div></div></div><div class="post-tags"><a href="/tags/Flutter/" rel="tag"># Flutter</a> <a href="/tags/Flame/" rel="tag"># Flame</a> <a href="/tags/Game/" rel="tag"># Game</a></div><div class="post-nav"><div class="post-nav-item"><a href="/I-am-Back.html" rel="prev" title="I am Back"><i class="fa fa-chevron-left"></i> I am Back</a></div><div class="post-nav-item"><a href="/iOS%E5%BC%80%E5%8F%91%E8%80%85%E4%BB%AC%EF%BC%8C%E4%BD%A0%E4%BB%AC%E4%B9%9F%E8%AE%B8%E9%9C%80%E8%A6%81%E8%BF%995%E4%B8%AA%E7%A5%9E%E5%A5%87%E7%9A%84%E5%B7%A5%E5%85%B7.html" rel="next" title="iOS开发者们，你们也许需要这5个神奇的工具">iOS开发者们，你们也许需要这5个神奇的工具 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">木辛念做梓</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>站点总字数：</span> <span title="站点总字数">534k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>站点阅读时长 &asymp;</span> <span title="站点阅读时长">8:06</span></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script></body></html>