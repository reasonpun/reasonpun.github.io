---
layout: post
title: 系统设计基础——速率限制器
date: 2024-07-24 09:34:11
categories:
- System Design
tags:
- System
- Design
---

{% asset_img 1.webp 示意图 width="400" %}

### 你好，伙计们，如果你正在为系统设计面试做准备，你可能已经遇到了“速率限制器”，这是软件架构中的基本组件之一，与API网关、负载均衡器、分布式缓存等一起。

在今天的高流量、分布式系统架构中，应用程序和服务与许多用户和系统交互，维护稳定性和防止滥用是至关重要的问题。

而速率限制有助于解决这些问题。

想象一下，我们有一个服务，它接收到大量的请求，但它每秒只能处理有限数量的请求。为了处理这个问题，我们需要某种节流或速率限制机制，只允许一定数量的请求，这样我们的服务就可以响应所有请求。

<!--more-->

从高层次上讲，速率限制器限制了一个实体（用户、设备、IP等）在特定时间窗口内可以执行的事件数量。

换句话说，速率限制器是用于软件系统和网络通信中的一种机制，用于控制请求或操作的执行速率。

它旨在防止资源的过度使用，保护系统不被压垮，并确保多个用户或客户端之间的公平使用。它可以在应用程序、API网关或网络层等不同级别应用。

速率限制器对于在分布式系统和高流量应用程序中维护系统稳定性、确保服务质量和管理资源非常关键。

顺便说一下，如果你正在为系统设计面试做准备，并希望在有限的时间内学习系统设计，你还可以查看像ByteByteGo、Design Guru、Exponent、Educative和Udemy这样的网站，它们有许多优秀的系统设计课程。

类似地，在回答系统设计问题时，你也可以遵循像DesignGuru这样的系统设计模板，以便在有限的时间内更好地表达你的答案。

遵循这个模板实际上是你为任何系统设计面试做准备的最好的事情之一。

{% asset_img 2.webp 示意图 width="400" %}

**什么是速率限制器？**
速率限制器是一种用于计算中控制某些操作或请求被允许的速率的机制。它通常在各种应用程序和系统中使用，以防止滥用、保护资源和维护稳定性。

速率限制器的基本思想是限制用户或系统在指定期间内可以执行的请求或操作数量。

这样做是为了防止服务过载、避免不必要的资源消耗，并防止潜在的恶意活动或无意的误用。

这里有一个简单的速率限制器工作原理的解释：

- **定义限制**：指定在某个时间窗口内允许的最大请求或操作数量。例如，你可能只允许每分钟100个请求。
- **跟踪使用情况**：速率限制器会跟踪用户或系统随时间所做的请求数量。
- **检查限制**：在处理新请求之前，速率限制器会检查用户或系统是否在当前时间窗口内超过了定义的限制。
- **决策制定**：如果用户或系统在允许的限制内，请求将被处理。否则，请求可能会被延迟、拒绝或根据具体实现采取其他行动。

以下是Exponent的一个漂亮的图表，展示了速率限制器的实际应用：

{% asset_img 3.webp 示意图 width="400" %}

**速率限制器算法**
根据系统的要求和特性，有不同算法和策略来实现速率限制。一些常见的速率限制算法包括：

- **令牌桶**：只要桶中有令牌可用，就可以授予请求。令牌以固定速率添加到桶中，每个请求消耗一个或多个令牌。
- **漏桶**：类似于令牌桶，但不是令牌，而是请求以固定速率从桶中漏出。如果桶溢出，多余的请求可能会被延迟或丢弃。
- **滑动窗口**：在滑动时间窗口内计算请求的数量。如果计数超过允许的限制，进一步的请求将被延迟或拒绝。

速率限制在Web API、网络协议、Web服务器和各种分布式系统中广泛使用，以确保公平使用、防止滥用和维护系统稳定性。

如果你想了解更多，ByteByteGo的速率限制器章节是一个很好的资源，我大部分知识都是从那里学到的。

以下是ByteByteGo的一个漂亮的图表，用简单的语言解释了速率限制器的工作原理：

{% asset_img 4.webp 示意图 width="400" %}

**系统设计面试资源**
这里是一份精选的最佳系统设计书籍、在线课程和练习网站的列表，你可以查看这些资源，更好地为系统设计面试做准备。这些课程大多也回答了我在这里分享的问题。

- DesignGuru的《掌握系统设计课程》：一个互动学习平台，有动手练习和现实场景，以加强你的系统设计技能。
- Alex Xu的《系统设计面试》：这本书深入探讨了系统设计概念、策略和面试准备技巧。
- Martin Kleppmann的《设计数据密集型应用》：一本全面指南，涵盖了设计可扩展和可靠系统的原则和实践。
- LeetCode系统设计标签：LeetCode是一个流行的技术面试准备平台。LeetCode上的系统设计标签包括各种问题供练习。
- GitHub上的《系统设计入门》：一份精选资源列表，包括文章、书籍和视频，帮助你为系统设计面试做准备。
- Educative的系统设计课程：一个互动学习平台，有动手练习和现实场景，以加强你的系统设计技能。
- High Scalability博客：一个博客，展示高流量网站和可扩展系统架构的文章和案例研究。
- YouTube频道：查看“Gaurav Sen”和“Tech Dummies”等频道，了解系统设计概念和面试准备的有见地的视频。
- ByteByteGo：Alex Xu为系统设计面试准备的活书和课程。它包含了《系统设计面试》第一卷和第二卷的全部内容，并将在第三卷发布时更新。
- Exponent：一个专门针对FAANG公司（如亚马逊和谷歌）面试准备的网站，他们也有一个很好的系统设计课程和许多其他材料，可以帮助你通过FAANG面试。

以下是一份漂亮的系统设计面试备忘单，用于快速复习基本的系统设计概念：

{% asset_img 5.webp 示意图 width="400" %}

**结论**
这就是关于什么是速率限制器以及它是如何工作的。速率限制器是任何软件架构师手中的重要工具，你可以把它放在任何你想防止资源耗尽的地方。

它也是系统设计面试中需要学习的基本概念之一。许多公司还会询问关于设计API速率限制器的问题。我的意思是，你可能会被要求设计一个API速率限制器，根据用户发送的请求数量来限制用户。

<!-- https://medium.com/javarevisited/system-design-basics-rate-limiter-249013cf5be4 -->